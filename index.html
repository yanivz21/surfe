<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kate Surfing Game</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #87CEEB;
        }
        #gameCanvas {
            background-color: #87CEEB;
        }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let canvasWidth = window.innerWidth;
    let canvasHeight = window.innerHeight;
    canvas.width = canvasWidth;
    canvas.height = canvasHeight;

    const kate = {
        x: canvasWidth * 0.1,
        y: canvasHeight * 0.8,
        width: 60,
        height: 120,
        yVelocity: 0,
        gravity: 0.4, // ערך מוגבר לכוח הכבידה
        jumpStrength: -1.0, // כוח קפיצה מתון יותר
        maxYPosition: canvasHeight * 0.1 // גובה עליון של הגולש
    };

    const fishList = [];
    const lobsterList = [];
    const phoneList = [];
    const maxFishOnScreen = 5; // פחות דגים על המסך בו זמנית

    let score = 0;

    function createFish() {
        if (fishList.length < maxFishOnScreen) {
            fishList.push({
                x: canvasWidth,
                y: Math.random() * (canvasHeight * 0.75),
                width: 50,
                height: 30,
                type: "fish",
            });
        }
    }

    function createLobster() {
        if (Math.random() < 0.1) {
            lobsterList.push({
                x: canvasWidth,
                y: Math.random() * (canvasHeight * 0.75),
                width: 60,
                height: 40,
                type: "lobster",
            });
        }
    }

    function createPhone() {
        if (phoneList.length === 0 && Math.random() < 0.05) {
            phoneList.push({
                x: canvasWidth,
                y: Math.random() * (canvasHeight * 0.75),
                width: 40,
                height: 60,
                type: "phone",
            });
        }
    }

    function updateKate() {
        kate.yVelocity += kate.gravity;
        kate.y += kate.yVelocity;

        if (kate.y + kate.height > canvasHeight) {
            kate.y = canvasHeight - kate.height;
            kate.yVelocity = 0;
        }

        if (kate.y < kate.maxYPosition) {
            kate.y = kate.maxYPosition;
            kate.yVelocity = 0;
        }
    }

    function jump() {
        kate.yVelocity = kate.jumpStrength;
    }

    function updateObjects() {
        fishList.forEach((fish, index) => {
            fish.x -= 2;
            if (fish.x + fish.width < 0) {
                fishList.splice(index, 1);
            }
        });

        lobsterList.forEach((lobster, index) => {
            lobster.x -= 2;
            if (lobster.x + lobster.width < 0) {
                lobsterList.splice(index, 1);
            }
        });

        phoneList.forEach((phone, index) => {
            phone.x -= 2;
            if (phone.x + phone.width < 0) {
                phoneList.splice(index, 1);
            }
        });
    }

    function checkCollisions() {
        fishList.forEach((fish) => {
            if (
                kate.x < fish.x + fish.width &&
                kate.x + kate.width > fish.x &&
                kate.y < fish.y + fish.height &&
                kate.y + kate.height > fish.y
            ) {
                alert("Game Over!");
                resetGame();
            }
        });

        lobsterList.forEach((lobster, index) => {
            if (
                kate.x < lobster.x + lobster.width &&
                kate.x + kate.width > lobster.x &&
                kate.y < lobster.y + lobster.height &&
                kate.y + kate.height > lobster.y
            ) {
                score++;
                lobsterList.splice(index, 1);
            }
        });

        phoneList.forEach((phone, index) => {
            if (
                kate.x < phone.x + phone.width &&
                kate.x + kate.width > phone.x &&
                kate.y < phone.y + phone.height &&
                kate.y + kate.height > phone.y
            ) {
                alert("Caught the phone!");
                phoneList.splice(index, 1);
            } else if (phone.x + phone.width < 0) {
                alert("Missed the phone!");
            }
        });
    }

    function resetGame() {
        kate.y = canvasHeight * 0.8;
        kate.yVelocity = 0;
        fishList.length = 0;
        lobsterList.length = 0;
        phoneList.length = 0;
        score = 0;
    }

    function drawKate() {
        ctx.fillStyle = "blue";
        ctx.fillRect(kate.x, kate.y, kate.width, kate.height);
    }

    function drawObjects() {
        ctx.fillStyle = "green";
        fishList.forEach((fish) => {
            ctx.fillRect(fish.x, fish.y, fish.width, fish.height);
        });

        ctx.fillStyle = "red";
        lobsterList.forEach((lobster) => {
            ctx.fillRect(lobster.x, lobster.y, lobster.width, lobster.height);
        });

        ctx.fillStyle = "purple";
        phoneList.forEach((phone) => {
            ctx.fillRect(phone.x, phone.y, phone.width, phone.height);
        });
    }

    function drawScore() {
        ctx.fillStyle = "black";
        ctx.font = "20px Arial";
        ctx.fillText("Score: " + score, canvasWidth / 2 - 50, 30);
    }

    function gameLoop() {
        ctx.clearRect(0, 0, canvasWidth, canvasHeight);

        updateKate();
        updateObjects();
        checkCollisions();

        drawKate();
        drawObjects();
        drawScore();

        requestAnimationFrame(gameLoop);
    }

    document.addEventListener("click", jump);

    function preventPortraitMode() {
        if (window.innerHeight > window.innerWidth) {
            alert("Please rotate your device to landscape mode.");
        }
    }

    window.addEventListener("resize", preventPortraitMode);
    preventPortraitMode();

    setInterval(createFish, 2000);
    setInterval(createLobster, 5000);
    setInterval(createPhone, 7000);

    gameLoop();
</script>

</body>
</html>
