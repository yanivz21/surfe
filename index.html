<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Kate Surfing Game</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: lightblue;
        }
        canvas {
            background-color: lightblue;
        }
        #jumpButton, #startButton, .overlay {
            font-size: calc(2vw + 2vh);
        }
        #jumpButton {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            background-color: red;
            color: white;
            font-size: 20px;
            border: none;
            cursor: pointer;
            border-radius: 10px;
        }
        #startButton {
            position: absolute;
            top: calc(50% + 300px);
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 15px 30px;
            background-color: green;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            display: none;
        }
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
            display: none;
        }
        .score-guide {
            padding: 10px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            text-align: center;
        }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<button id="jumpButton">Jump</button>
<div id="overlay" class="overlay">
    <div class="score-guide">
        <h2>Score Legend</h2>
        <p>Collect Lobster: +1 point <img src="lobster_image.png" alt="lobster" width="30" height="30" /></p>
        <p>Hit Phone: +5 points <img src="phone_image.png" alt="phone" width="30" height="30" /></p>
        <p>Miss Phone: -5 points <img src="phone_image.png" alt="phone" width="30" height="30" /></p>
        <p>Hit Fish: Game Over <img src="fish1.png" alt="fish" width="30" height="30" /></p>
    </div>
</div>
<button id="startButton">Start Game</button>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    function setScaleFactor() {
        let scaleFactor;
        if (window.innerWidth > window.innerHeight) {
            scaleFactor = Math.min(window.innerWidth / 1280, window.innerHeight / 720);
        } else {
            scaleFactor = Math.min(window.innerWidth / 720, window.innerHeight / 1280);
        }
        return scaleFactor;
    }

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        scaleFactor = setScaleFactor();

        kate.width = 80 * scaleFactor;
        kate.height = 80 * scaleFactor;
        kate.jumpForce = 5 * scaleFactor;
        kate.gravity = 0.2 * scaleFactor;

        obstacleSpeed = 1.5 * scaleFactor;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const surferImage = new Image();
    surferImage.src = 'surfer_with_surfboard.png';

    let kate = {
        x: 50,
        y: canvas.height - 120,
        width: 80,
        height: 80,
        dy: 0,
        gravity: 0.2,
        jumpForce: 5,
        isJumping: false
    };

    let score = 0;
    let obstacles = [];
    let frameCount = 0;
    const spawnRate = 100;
    let obstacleSpeed = 1.5;
    let gameStarted = false;

    const jumpButton = document.getElementById("jumpButton");
    const startButton = document.getElementById("startButton");
    const overlay = document.getElementById("overlay");

    startButton.addEventListener("click", startGame);
    jumpButton.addEventListener("mousedown", jump);
    window.addEventListener("keydown", (event) => {
        if (event.code === "Space") jump();
    });

    function jump() {
        if (gameStarted && !kate.isJumping) {
            kate.dy = -kate.jumpForce;
            kate.isJumping = true;
        }
    }

    function startGame() {
        score = 0;
        obstacles = [];
        frameCount = 0;
        gameStarted = true;
        overlay.style.display = 'none';
        startButton.style.display = 'none';
        gameLoop();
    }

    function spawnObstacle() {
        const isPhone = Math.random() < 0.1;
        const isLobster = !isPhone && Math.random() < 0.1;
        const yPosition = isPhone ? Math.random() * (canvas.height - 60) : Math.random() * canvas.height;
        const obstacle = {
            x: canvas.width,
            y: yPosition,
            width: 40 * scaleFactor,
            height: 40 * scaleFactor,
            dx: obstacleSpeed,
            isLobster: isLobster,
            isPhone: isPhone,
            image: new Image()
        };
        obstacle.image.src = isLobster ? 'lobster_image.png' : isPhone ? 'phone_image.png' : 'fish1.png';
        obstacles.push(obstacle);
    }

    function updateKate() {
        kate.dy += kate.gravity;
        kate.y += kate.dy;

        if (kate.y > canvas.height - kate.height) {
            kate.y = canvas.height - kate.height;
            kate.isJumping = false;
        }
        if (kate.y < 0) kate.y = 0;
    }

    function updateObstacles() {
        obstacles.forEach(obstacle => obstacle.x -= obstacle.dx);
        obstacles = obstacles.filter(obstacle => obstacle.x + obstacle.width > 0);
    }

    function checkCollision() {
        obstacles.forEach(obstacle => {
            if (
                kate.x < obstacle.x + obstacle.width &&
                kate.x + kate.width > obstacle.x &&
                kate.y < obstacle.y + obstacle.height &&
                kate.y + kate.height > obstacle.y
            ) {
                if (obstacle.isPhone) score += 5;
                else if (obstacle.isLobster) score += 1;
                else gameOver();

                obstacles = obstacles.filter(o => o !== obstacle);
            } else if (obstacle.x < 0 && obstacle.isPhone) {
                score -= 5;
                obstacles = obstacles.filter(o => o !== obstacle);
            }
        });
    }

    function gameOver() {
        gameStarted = false;
        overlay.style.display = 'flex';
        startButton.style.display = 'block';
    }

    function gameLoop() {
        if (gameStarted) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            updateKate();
            updateObstacles();
            checkCollision();

            ctx.drawImage(surferImage, kate.x, kate.y, kate.width, kate.height);

            obstacles.forEach(obstacle => {
                ctx.drawImage(obstacle.image, obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });

            ctx.font = `${20 * scaleFactor}px Arial`;
            ctx.fillStyle = "black";
            ctx.fillText("Score: " + score, 20 * scaleFactor, 30 * scaleFactor);

            frameCount++;
            if (frameCount % spawnRate === 0) spawnObstacle();
            requestAnimationFrame(gameLoop);
        }
    }

    startGame();
</script>
</body>
</html>
